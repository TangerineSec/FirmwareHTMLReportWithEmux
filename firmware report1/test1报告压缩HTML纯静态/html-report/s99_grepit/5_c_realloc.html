<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s99_grepit.html" title="./../s99_grepit.html" >&laquo; Back to s99_grepit</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<pre>[</span><span class="orange">*</span>] Searching (args for grep: </span><span class="orange"></span>) for </span><span class="orange">realloc\(</span>.</pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - comment: </span><span class="orange">realloc. Rather rare bug, but see issues <a href="https://nvd.nist.gov/vuln/detail/CVE-2010-0041" title="CVE-2010-0041" target="_blank" >CVE-2010-0041</a> and <a href="https://nvd.nist.gov/vuln/detail/CVE-2010-0042" title="CVE-2010-0042" target="_blank" >CVE-2010-0042</a>. Uninitialized memory access issues? Could also happen in java/android native code. Also developers should check return codes.</span></pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - Filename </span><span class="orange">5_c_realloc.txt</span></pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - Example: </span><span class="orange">realloc(</span></pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - False positive example: </span><span class="orange">FALSE_POSITIVES_EXAMPLE_PLACEHOLDER</span></pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - Grep args: </span><span class="orange"></span></pre>
<pre>[</span><span class="orange">*</span>] Grepit state info - Search regex: </span><span class="orange">realloc\(</span></pre>
<br />
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/samba_multicall</span><span class="cyan">-</span><span class="green">2095</span><span class="cyan">-</span>%s.out./%sconnection_structstruct dfree_cached_info*.*struct smb_Dirstruct name_cache_entry%s%s%suser.DOSATTRIBsmbd/error.cwritetimeupdatedelayupdate_write_time_handlerset_filelen_write_cache: size change on file %s with write cache size = %lu</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/samba_multicall</span><span class="cyan">-</span><span class="green">2096</span><span class="cyan">-</span>set_filelen_write_cache/.%s/%s/%sstruct files_structstruct fd_handlefile_find_difstruct print_file_dataCould not init smbd's messaging context.</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/samba_multicall</span><span class="cyan">-</span><span class="green">2097</span><span class="cyan">-</span>Could not init smbd memcachefailed to create smbd_server_connectionstruct smb_requeststruct dcerpc_cmd_statesmbd/ipc.capi_dcerpc_cmd_write_done: srv_send_smb failed.send_trans_reply: srv_send_smb failed.api_dcerpc_cmd_read_done: srv_send_smb failed.\%s\\PIPELANMANWKSSVCSRVSVCWINREGSAMRLSARPCstruct trans_stateuint16B13B13BWzWWWzB9BB13BWzWWWzB9BB9BWzWWzWWzzhsrv_comp(&amp;((servers)[0]), &amp;((servers)[1])) &lt;= 0smbd/lanman.cWrLehDzWrLehWrLhzzzBBzzB16BBDzDDDWWzWWWWWWWBB21zWWWWWWWWWWWWWWWWWWWWWWzB16BBDzDDDWWzWWWWWWWBB21zWWWWWWWWWWWWWWWWWWWWWWzDWzDNB16BBDzWWzzzzWrLhRNetShareEnumRNetShareGetInfoRNetShareAddRNetSessionEnumRNetServerGetInfoRNetGroupEnumRNetGroupGetUsersRNetUserEnumRNetUserGetInfoNetUserGetGroupsNetWkstaGetInfoDosPrintQEnumDosPrintQGetInfoWPrintQueuePauseWPrintQueueResumeWPrintJobEnumerateWPrintJobGetInfoRDosPrintJobDelRDosPrintJobPauseRDosPrintJobResumeWPrintDestEnumWPrintDestGetInfoNetRemoteTODWPrintQueuePurgeNetServerEnum2NetServerEnum3WAccessGetUserPermsSetUserPasswordWWkstaUserLogonPrintJobInfoWPrintDriverEnumWPrintQProcEnumWPrintPortEnumSamOEMChangePasswordXmQXkQX IQX(EQXbQ$X/&commat;BQ4X4\QHX5AQXX8HQhX;GQ|X?^QXEPGQXFDQXJFQXKFQXLPDQXMCQXQHFQXRHFQ$XSHFQ8XTxCQHXUCQ\X[p]QlXgFQXhWQX</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/samba_multicall</span><span class="cyan">:</span><span class="green">2098</span><span class="cyan">:</span> !"#Q$Q,Q4Q&lt;QDQ%s/msg.XXXXXXsmbd/message.cstruct msg_statemsdfs:struct referralstruct dfs_pathsetup_dfs_referralstruct junction_map&lt;NULL&gt;%cID %lu%cGIDcannot make_negprot_global_auth_context!not_defined_in_RFC4178&commat;please_ignorecifs/%s&commat;%sreply_nt1: smb signing required and share level security selected.smbd/negprot.cmultiple negprot's are not permittedWindows for Workgroups 3.1aDOS LM1.2X002DOS LANMAN2.1NT LM 0.12SMB 2.001MICROSOFT NETWORKS 1.03XENIX COREPOSIX 2SMB signing is required and client negotiated a downlevel protocolFailed to fork echo handlerSMB 2.002NT LANMAN 1.0LANMAN1.0MICROSOFT NETWORKS 3.0PC NETWORK PROGRAM 1.0&commat;W$&commat;XXWXXTXpWDQHXpWDQXpWDQ&lt;XtWQ,XtWQWtWQ(XtWQX|WQX|WQ`XWÈ¼Q,XWxQnotify_req not found in fsp's requestsstruct notify_change_bufstruct notify_change_requeststruct notify_mid_mapFILE_NAME|DIR_NAME|ATTRIBUTES|SIZE|LAST_WRITE|LAST_ACCESS|CREATION|EA|SECURITY|STREAM_NAME|STREAM_SIZE|STREAM_WRITE|struct sys_notify_contextstruct inotify_privateinotifyinotify_handlerstruct inotify_watch_context</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/samba_multicall</span><span class="cyan">-</span><span class="green">2099</span><span class="cyan">-</span>send_break_message_smb1: srv_send_smb failed.oplock_timeout_handlerstruct kernel_oplockslinux_oplock_signal_handlerRÜ›Rregister_initial_vuid: Tried to register uid in security=shareuser_structperfcountstruct pipe_read_andx_statesmbd/pipes.cstruct pipe_write_andx_statestruct pipe_write_stateconstruct_reply: srv_send_smb failed.RRXR&commat;RRRuser.SAMBA_PAIstruct idle_eventsmbd_idle_event_handlerNon-SMB packetsmbd/process.cencryption required on connectionstruct smbd_echo_statereceive_smb_raw_talloc_partial_read: failed to drain pending bytesfailed to lock socketfailed to unlock socketcould not allocate smb_requestInvalid SMB requestfailed to drain pending bytesfailed to receive smb requestnum_bytes too large: %unum_bytes too largestruct pending_message_listsmbd_deferred_open_timer: talloc failed</pre>
<pre><span class="cyan">--</span></pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/miniupnpd</span><span class="cyan">-</span><span class="green">268</span><span class="cyan">-</span>%u.%u.%u.%u%s : iptc_init() error : %s</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/miniupnpd</span><span class="cyan">-</span><span class="green">269</span><span class="cyan">-</span>%s : chain %s not found%s : iptc_append_entry() error : %s</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/miniupnpd</span><span class="cyan">-</span><span class="green">270</span><span class="cyan">-</span>%s : iptc_commit() error : %s</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/sbin/miniupnpd</span><span class="cyan">:</span><span class="green">271</span><span class="cyan">:</span>DNATnataddnatrule()ACCEPTfilteradd_filter_rule()get_redirect_rule() : iptc_init() failed : %schain %s not foundget_redirect_rule_by_index() : iptc_init() failed : %sdelete_redirect_and_filter_rules() : iptc_init() failed : %sTrying to delete nat rule at index %udelete_redirect_ruleTrying to delete filter rule at index %udelete_filter_ruleget_portmappings_in_range() : calloc errorget_portmappings_in_range() : <span class="bold"><span class="red">realloc(</span>%u) error9+A,A,AOpenWRT router100000000uuid:00000000-0000-0000-0000-000000000000,A &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat; &commat;</pre>
<pre><span class="cyan">--</span></pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/lib/libntfs-3g.so.81.0.0</span><span class="cyan">-</span><span class="green">994</span><span class="cyan">-</span>Failed to open inode %lld with indexFailed to get index ctx, inode %lldIndex lookup failed, inode %lldFailed to sync FILE_NAME (inode %lld)Attribute list sync failed (open, inode %lld)Attribute list sync failed (write, inode %lld)Attribute list sync failed (bad size, inode %lld)</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/lib/libntfs-3g.so.81.0.0</span><span class="cyan">-</span><span class="green">995</span><span class="cyan">-</span>MFT record sync failed, inode %lldExtent MFT record sync failed, inode %lld/%lld%s: ni=%p size=%dFailed to move out attribute #2Inode already has attribute listAttribute list already presentFailed to realloc %d bytes%s: Attribute lookup failed, inode %lldFailed to free space for attrlistCouldn't add $ATTRIBUTE_LIST to MFTFailed to open just added $ATTRIBUTE_LISTFailed to resize just added $ATTRIBUTE_LISTRollback failed to remove attrlistRollback failed to find attrlistRollback failed to move attributeRollback failed to find attr%s(): Invalid arguments.</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/lib/libntfs-3g.so.81.0.0</span><span class="cyan">-</span><span class="green">996</span><span class="cyan">-</span>Invalid argument.</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/lib/libntfs-3g.so.81.0.0</span><span class="cyan">:</span><span class="green">997</span><span class="cyan">:</span>$BadCouldn't convert '$Bad' to Unicodentfs_inode_real_close__ntfs_inode_releasentfs_inode_real_openntfs_extent_inode_openntfs_inode_sync_in_dirntfs_inode_sync_standard_informationntfs_inode_sync_file_namentfs_inode_add_attrlistntfs_inode_free_spacentfs_inode_update_timesntfs_inode_badclus_badlcnalloc.cBitmap write error (%lld, %lld)Cluster deallocation failed (%lld, %lld)Too many free clusters (%lld &gt; %lld)!%s: vcn: %lld, count: %lld, lcn: %lldReading $BITMAP failed<span class="bold"><span class="red">realloc(</span>) failedNon-positive free clusters (%lld)!</pre>
<pre><span class="magenta">/logs/firmware/squashfs-root/usr/lib/libntfs-3g.so.81.0.0</span><span class="cyan">-</span><span class="green">998</span><span class="cyan">-</span>Failed to allocate clusters%s: Unexpected lcn (%lld)%s: Invalid lcn (%lli)%s: Clearing bitmap run failed%s: count still not zero (%lld)ntfs_cluster_allocbitmap_writebackntfs_cluster_free_from_rlntfs_cluster_free_basicntfs_cluster_freelogfile.c$LogFile is too small.</pre>
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>

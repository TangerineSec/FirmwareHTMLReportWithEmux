CVE-2009-2957:6.8:NA:Heap-based\ buffer\ overflow\ in\ the\ tftp_request\ function\ in\ tftp.c\ in\ dnsmasq\ before\ 2.50\,\ when\ --enable-tftp\ is\ used\,\ might\ allow\ remote\ attackers\ to\ execute\ arbitrary\ code\ via\ a\ long\ filename\ in\ a\ TFTP\ packet\,\ as\ demonstrated\ by\ a\ read\ \(aka\ RRQ\)\ request.
CVE-2009-2958:4.3:NA:The\ tftp_request\ function\ in\ tftp.c\ in\ dnsmasq\ before\ 2.50\,\ when\ --enable-tftp\ is\ used\,\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(NULL\ pointer\ dereference\ and\ daemon\ crash\)\ via\ a\ TFTP\ read\ \(aka\ RRQ\)\ request\ with\ a\ malformed\ blksize\ option.
CVE-2013-0198:5.0:NA:Dnsmasq\ before\ 2.66test2\,\ when\ used\ with\ certain\ libvirt\ configurations\,\ replies\ to\ queries\ from\ prohibited\ interfaces\,\ which\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(traffic\ amplification\)\ via\ spoofed\ TCP\ based\ DNS\ queries.\ \ NOTE:\ this\ vulnerability\ exists\ because\ of\ an\ incomplete\ fix\ for\ CVE-2012-3411.
CVE-2012-3411:5.0:NA:Dnsmasq\ before\ 2.63test1\,\ when\ used\ with\ certain\ libvirt\ configurations\,\ replies\ to\ requests\ from\ prohibited\ interfaces\,\ which\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(traffic\ amplification\)\ via\ a\ spoofed\ DNS\ query.
CVE-2015-3294:6.4:NA:The\ tcp_request\ function\ in\ Dnsmasq\ before\ 2.73rc4\ does\ not\ properly\ handle\ the\ return\ value\ of\ the\ setup_reply\ function\,\ which\ allows\ remote\ attackers\ to\ read\ process\ memory\ and\ cause\ a\ denial\ of\ service\ \(out-of-bounds\ read\ and\ crash\)\ via\ a\ malformed\ DNS\ request.
CVE-2017-14491:7.5:9.8:Heap-based\ buffer\ overflow\ in\ dnsmasq\ before\ 2.78\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(crash\)\ or\ execute\ arbitrary\ code\ via\ a\ crafted\ DNS\ response.
CVE-2015-8899:5.0:NA:Dnsmasq\ before\ 2.76\ allows\ remote\ servers\ to\ cause\ a\ denial\ of\ service\ \(crash\)\ via\ a\ reply\ with\ an\ empty\ DNS\ address\ that\ has\ an\ \(1\)\ A\ or\ \(2\)\ AAAA\ record\ defined\ locally.
CVE-2017-13704:5.0:NA:In\ dnsmasq\ before\ 2.78\,\ if\ the\ DNS\ packet\ size\ does\ not\ match\ the\ expected\ size\,\ the\ size\ parameter\ in\ a\ memset\ call\ gets\ a\ negative\ value.\ As\ it\ is\ an\ unsigned\ value\,\ memset\ ends\ up\ writing\ up\ to\ 0xffffffff\ zero\'s\ \(0xffffffffffffffff\ in\ 64\ bit\ platforms\)\,\ making\ dnsmasq\ crash.
CVE-2017-14492:7.5:NA:Heap-based\ buffer\ overflow\ in\ dnsmasq\ before\ 2.78\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(crash\)\ or\ execute\ arbitrary\ code\ via\ a\ crafted\ IPv6\ router\ advertisement\ request.
CVE-2017-14493:7.5:NA:Stack-based\ buffer\ overflow\ in\ dnsmasq\ before\ 2.78\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(crash\)\ or\ execute\ arbitrary\ code\ via\ a\ crafted\ DHCPv6\ request.
CVE-2017-14494:4.3:NA:dnsmasq\ before\ 2.78\,\ when\ configured\ as\ a\ relay\,\ allows\ remote\ attackers\ to\ obtain\ sensitive\ memory\ information\ via\ vectors\ involving\ handling\ DHCPv6\ forwarded\ requests.
CVE-2017-14496:7.8:NA:Integer\ underflow\ in\ the\ add_pseudoheader\ function\ in\ dnsmasq\ before\ 2.78\ \,\ when\ the\ --add-mac\,\ --add-cpe-id\ or\ --add-subnet\ option\ is\ specified\,\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ via\ a\ crafted\ DNS\ request.
CVE-2017-14495:5.0:NA:Memory\ leak\ in\ dnsmasq\ before\ 2.78\,\ when\ the\ --add-mac\,\ --add-cpe-id\ or\ --add-subnet\ option\ is\ specified\,\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(memory\ consumption\)\ via\ vectors\ involving\ DNS\ response\ creation.
CVE-2019-14513:5.0:7.5:Improper\ bounds\ checking\ in\ Dnsmasq\ before\ 2.76\ allows\ an\ attacker\ controlled\ DNS\ server\ to\ send\ large\ DNS\ packets\ that\ result\ in\ a\ read\ operation\ beyond\ the\ buffer\ allocated\ for\ the\ packet\,\ a\ different\ vulnerability\ than\ CVE-2017-14491.
CVE-2017-15107:5.0:NA:A\ vulnerability\ was\ found\ in\ the\ implementation\ of\ DNSSEC\ in\ Dnsmasq\ up\ to\ and\ including\ 2.78.\ Wildcard\ synthesized\ NSEC\ records\ could\ be\ improperly\ interpreted\ to\ prove\ the\ non-existence\ of\ hostnames\ that\ actually\ exist.
CVE-2020-25681:8.3:8.1:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ A\ heap-based\ buffer\ overflow\ was\ discovered\ in\ the\ way\ RRSets\ are\ sorted\ before\ validating\ with\ DNSSEC\ data.\ An\ attacker\ on\ the\ network\,\ who\ can\ forge\ DNS\ replies\ such\ as\ that\ they\ are\ accepted\ as\ valid\,\ could\ use\ this\ flaw\ to\ cause\ a\ buffer\ overflow\ with\ arbitrary\ data\ in\ a\ heap\ memory\ segment\,\ possibly\ executing\ code\ on\ the\ machine.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ confidentiality\ and\ integrity\ as\ well\ as\ system\ availability.
CVE-2019-14834:4.3:3.7:A\ vulnerability\ was\ found\ in\ dnsmasq\ before\ version\ 2.81\,\ where\ the\ memory\ leak\ allows\ remote\ attackers\ to\ cause\ a\ denial\ of\ service\ \(memory\ consumption\)\ via\ vectors\ involving\ DHCP\ response\ creation.
CVE-2020-25682:8.3:8.1:A\ flaw\ was\ found\ in\ dnsmasq\ before\ 2.83.\ A\ buffer\ overflow\ vulnerability\ was\ discovered\ in\ the\ way\ dnsmasq\ extract\ names\ from\ DNS\ packets\ before\ validating\ them\ with\ DNSSEC\ data.\ An\ attacker\ on\ the\ network\,\ who\ can\ create\ valid\ DNS\ replies\,\ could\ use\ this\ flaw\ to\ cause\ an\ overflow\ with\ arbitrary\ data\ in\ a\ heap-allocated\ memory\,\ possibly\ executing\ code\ on\ the\ machine.\ The\ flaw\ is\ in\ the\ rfc1035.c:extract_name\(\)\ function\,\ which\ writes\ data\ to\ the\ memory\ pointed\ by\ name\ assuming\ MAXDNAME\*2\ bytes\ are\ available\ in\ the\ buffer.\ However\,\ in\ some\ code\ execution\ paths\,\ it\ is\ possible\ extract_name\(\)\ gets\ passed\ an\ offset\ from\ the\ base\ buffer\,\ thus\ reducing\,\ in\ practice\,\ the\ number\ of\ available\ bytes\ that\ can\ be\ written\ in\ the\ buffer.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ confidentiality\ and\ integrity\ as\ well\ as\ system\ availability.
CVE-2020-25685:4.3:3.7:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ When\ getting\ a\ reply\ from\ a\ forwarded\ query\,\ dnsmasq\ checks\ in\ forward.c:reply_query\(\)\,\ which\ is\ the\ forwarded\ query\ that\ matches\ the\ reply\,\ by\ only\ using\ a\ weak\ hash\ of\ the\ query\ name.\ Due\ to\ the\ weak\ hash\ \(CRC32\ when\ dnsmasq\ is\ compiled\ without\ DNSSEC\,\ SHA-1\ when\ it\ is\)\ this\ flaw\ allows\ an\ off-path\ attacker\ to\ find\ several\ different\ domains\ all\ having\ the\ same\ hash\,\ substantially\ reducing\ the\ number\ of\ attempts\ they\ would\ have\ to\ perform\ to\ forge\ a\ reply\ and\ get\ it\ accepted\ by\ dnsmasq.\ This\ is\ in\ contrast\ with\ RFC5452\,\ which\ specifies\ that\ the\ query\ name\ is\ one\ of\ the\ attributes\ of\ a\ query\ that\ must\ be\ used\ to\ match\ a\ reply.\ This\ flaw\ could\ be\ abused\ to\ perform\ a\ DNS\ Cache\ Poisoning\ attack.\ If\ chained\ with\ CVE-2020-25684\ the\ attack\ complexity\ of\ a\ successful\ attack\ is\ reduced.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ integrity.
CVE-2020-25683:7.1:5.9:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ A\ heap-based\ buffer\ overflow\ was\ discovered\ in\ dnsmasq\ when\ DNSSEC\ is\ enabled\ and\ before\ it\ validates\ the\ received\ DNS\ entries.\ A\ remote\ attacker\,\ who\ can\ create\ valid\ DNS\ replies\,\ could\ use\ this\ flaw\ to\ cause\ an\ overflow\ in\ a\ heap-allocated\ memory.\ This\ flaw\ is\ caused\ by\ the\ lack\ of\ length\ checks\ in\ rfc1035.c:extract_name\(\)\,\ which\ could\ be\ abused\ to\ make\ the\ code\ execute\ memcpy\(\)\ with\ a\ negative\ size\ in\ get_rdata\(\)\ and\ cause\ a\ crash\ in\ dnsmasq\,\ resulting\ in\ a\ denial\ of\ service.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ system\ availability.
CVE-2020-25684:4.3:3.7:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ When\ getting\ a\ reply\ from\ a\ forwarded\ query\,\ dnsmasq\ checks\ in\ the\ forward.c:reply_query\(\)\ if\ the\ reply\ destination\ address/port\ is\ used\ by\ the\ pending\ forwarded\ queries.\ However\,\ it\ does\ not\ use\ the\ address/port\ to\ retrieve\ the\ exact\ forwarded\ query\,\ substantially\ reducing\ the\ number\ of\ attempts\ an\ attacker\ on\ the\ network\ would\ have\ to\ perform\ to\ forge\ a\ reply\ and\ get\ it\ accepted\ by\ dnsmasq.\ This\ issue\ contrasts\ with\ RFC5452\,\ which\ specifies\ a\ query\'s\ attributes\ that\ all\ must\ be\ used\ to\ match\ a\ reply.\ This\ flaw\ allows\ an\ attacker\ to\ perform\ a\ DNS\ Cache\ Poisoning\ attack.\ If\ chained\ with\ CVE-2020-25685\ or\ CVE-2020-25686\,\ the\ attack\ complexity\ of\ a\ successful\ attack\ is\ reduced.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ integrity.
CVE-2020-25686:4.3:3.7:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ When\ receiving\ a\ query\,\ dnsmasq\ does\ not\ check\ for\ an\ existing\ pending\ request\ for\ the\ same\ name\ and\ forwards\ a\ new\ request.\ By\ default\,\ a\ maximum\ of\ 150\ pending\ queries\ can\ be\ sent\ to\ upstream\ servers\,\ so\ there\ can\ be\ at\ most\ 150\ queries\ for\ the\ same\ name.\ This\ flaw\ allows\ an\ off-path\ attacker\ on\ the\ network\ to\ substantially\ reduce\ the\ number\ of\ attempts\ that\ it\ would\ have\ to\ perform\ to\ forge\ a\ reply\ and\ have\ it\ accepted\ by\ dnsmasq.\ This\ issue\ is\ mentioned\ in\ the\ \"Birthday\ Attacks\"\ section\ of\ RFC5452.\ If\ chained\ with\ CVE-2020-25684\,\ the\ attack\ complexity\ of\ a\ successful\ attack\ is\ reduced.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ integrity.
CVE-2020-25687:7.1:5.9:A\ flaw\ was\ found\ in\ dnsmasq\ before\ version\ 2.83.\ A\ heap-based\ buffer\ overflow\ was\ discovered\ in\ dnsmasq\ when\ DNSSEC\ is\ enabled\ and\ before\ it\ validates\ the\ received\ DNS\ entries.\ This\ flaw\ allows\ a\ remote\ attacker\,\ who\ can\ create\ valid\ DNS\ replies\,\ to\ cause\ an\ overflow\ in\ a\ heap-allocated\ memory.\ This\ flaw\ is\ caused\ by\ the\ lack\ of\ length\ checks\ in\ rfc1035.c:extract_name\(\)\,\ which\ could\ be\ abused\ to\ make\ the\ code\ execute\ memcpy\(\)\ with\ a\ negative\ size\ in\ sort_rrset\(\)\ and\ cause\ a\ crash\ in\ dnsmasq\,\ resulting\ in\ a\ denial\ of\ service.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ system\ availability.
CVE-2021-3448:4.3:4.0:A\ flaw\ was\ found\ in\ dnsmasq\ in\ versions\ before\ 2.85.\ When\ configured\ to\ use\ a\ specific\ server\ for\ a\ given\ network\ interface\,\ dnsmasq\ uses\ a\ fixed\ port\ while\ forwarding\ queries.\ An\ attacker\ on\ the\ network\,\ able\ to\ find\ the\ outgoing\ port\ used\ by\ dnsmasq\,\ only\ needs\ to\ guess\ the\ random\ transmission\ ID\ to\ forge\ a\ reply\ and\ get\ it\ accepted\ by\ dnsmasq.\ This\ flaw\ makes\ a\ DNS\ Cache\ Poisoning\ attack\ much\ easier.\ The\ highest\ threat\ from\ this\ vulnerability\ is\ to\ data\ integrity.
CVE-2022-0934:NA:7.5:A\ single-byte\,\ non-arbitrary\ write/use-after-free\ flaw\ was\ found\ in\ dnsmasq.\ This\ flaw\ allows\ an\ attacker\ who\ sends\ a\ crafted\ packet\ processed\ by\ dnsmasq\,\ potentially\ causing\ a\ denial\ of\ service.
CVE-2023-28450:NA:7.5:An\ issue\ was\ discovered\ in\ Dnsmasq\ before\ 2.90.\ The\ default\ maximum\ EDNS.0\ UDP\ packet\ size\ was\ set\ to\ 4096\ but\ should\ be\ 1232\ because\ of\ DNS\ Flag\ Day\ 2020.

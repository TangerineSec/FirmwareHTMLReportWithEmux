<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2024 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s) and contributors from the EMBA project are listed here: https://github.com/e-m-b-a/emba/blob/master/CONTRIBUTORS.md
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s14_weak_func_radare_check.html" title="./../s14_weak_func_radare_check.html" >&laquo; Back to s14_weak_func_radare_check</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<a class="reference" href="./vul_func_17_sprintf-ntfs-3g/s12_binary_protection.html" title="./vul_func_17_sprintf-ntfs-3g/s12_binary_protection.html" ><pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">ntfs-3g</span></pre></a>

<br />
<pre>  </pre>
<pre>  	<span class="red">No RELRO</span>       <span class="green">Canary found</span>      <span class="green">NX enabled</span>   <span class="red">No PIE</span>       <span class="green">No RPATH</span>     <span class="green">No RUNPATH</span>   <span class="red">Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">sprintf</span> tear down of </span><span class="orange">ntfs-3g</span></pre>
<br />
<pre>ldr r6, [r0]</pre>
<pre>mov r5, r1</pre>
<pre>mov r8, r2</pre>
<pre>cmp r6, 0</pre>
<pre>beq 0x16078</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.strlen</pre>
<pre>mov r7, r0</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.strlen</pre>
<pre>add r1, r8, 2</pre>
<pre>add r1, r1, r7</pre>
<pre>add r1, r1, r0</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.realloc</pre>
<pre>subs r6, r0, 0</pre>
<pre>beq 0x16088</pre>
<pre>add r0, r6, r7</pre>
<pre>ldr r1, [0x000160a4]</pre>
<pre>mov r2, r5</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>mov r0, 0</pre>
<pre>str r6, [r4]</pre>
<pre>--</pre>
<pre>bne 0x16ac8</pre>
<pre>mov r0, sb</pre>
<pre>mov r1, 1</pre>
<pre>bl sym.open64</pre>
<pre>cmn r0, 1</pre>
<pre>str r0, [sp, 8]</pre>
<pre>beq 0x16c84</pre>
<pre>mov r1, r4</pre>
<pre>bl sym.fstat64</pre>
<pre>cmn r0, 1</pre>
<pre>beq 0x16bf0</pre>
<pre>ldr r3, [sp, 0x1d0]</pre>
<pre>and r3, r3, 0xf000</pre>
<pre>cmp r3, segment.LOAD0</pre>
<pre>bne 0x16b50</pre>
<pre>mvn r3, 0</pre>
<pre>ldr r0, obj.procfile.4891</pre>
<pre>ldr r2, [sp, 8]</pre>
<pre>ldr r1, str._proc_self_fd__i</pre>
<pre>str r3, [sp, 0xc]</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>ldr ip, obj.procfile.4891</pre>
<pre>str ip, [sp, 0x28]</pre>
<pre>--</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.strlen</pre>
<pre>sub r0, r0, 1</pre>
<pre>ldrb r3, [r4, r0]</pre>
<pre>cmp r3, 0x2c</pre>
<pre>strbeq r5, [r4, r0]</pre>
<pre>bl sym.getuid</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0x16cb8</pre>
<pre>ldr r2, [sp, 0x24]</pre>
<pre>and r6, r2, 0xf000</pre>
<pre>bl sym.getuid</pre>
<pre>mov r4, r0</pre>
<pre>bl sym.getgid</pre>
<pre>ldr r1, str.fd_i_rootmode_o_user_id_i_group_id_i</pre>
<pre>mov r2, r8</pre>
<pre>str r0, [sp, 4]</pre>
<pre>mov r3, r6</pre>
<pre>ldr r0, [sp, 0x1c]</pre>
<pre>str r4, [sp]</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>cmp r7, 0</pre>
<pre>moveq r4, r7</pre>
<pre>--</pre>
<pre>str r0, [sp]</pre>
<pre>mov r3, sb</pre>
<pre>mov r0, r4</pre>
<pre>ldr r2, str.ntfs_3g_mount</pre>
<pre>bl sym.fprintf</pre>
<pre>b 0x16aec</pre>
<pre>ldr r0, [sp, 0x18]</pre>
<pre>ldr r1, [sp, 0x20]</pre>
<pre>bl sym.strcpy</pre>
<pre>b 0x1670c</pre>
<pre>bl sym.__errno_location</pre>
<pre>ldr r3, [r0]</pre>
<pre>cmp r3, 0x16</pre>
<pre>bne 0x16740</pre>
<pre>bl sym.getuid</pre>
<pre>ldr r1, str.fd_i_rootmode_o_user_id_i</pre>
<pre>mov r2, r8</pre>
<pre>str r0, [sp]</pre>
<pre>mov r3, r6</pre>
<pre>ldr r0, [sp, 0x1c]</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>ldr ip, [sp, 0x14]</pre>
<pre>mov r3, sl</pre>
<pre>--</pre>
<pre>bl sym.malloc</pre>
<pre>cmp r0, 0</pre>
<pre>mov r5, r0</pre>
<pre>mov r7, r0</pre>
<pre>beq 0x17adc</pre>
<pre>mov r0, r8</pre>
<pre>bl sym.strlen</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x17a20</pre>
<pre>add r3, sp, 0x1000</pre>
<pre>add r3, r3, 8</pre>
<pre>add r0, r3, r0</pre>
<pre>sub r0, r0, 0x1000</pre>
<pre>ldrb r3, [r0, -1]</pre>
<pre>cmp r3, 0x2f</pre>
<pre>beq 0x17b28</pre>
<pre>mov r0, r7</pre>
<pre>ldr r1, str._s__s</pre>
<pre>mov r2, r8</pre>
<pre>mov r3, r6</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>mov r0, r4</pre>
<pre>bl sym.free</pre>
<pre>--</pre>
<pre>mov r2, sl</pre>
<pre>ldr r1, str._s:_failed_to_allocate_memory_n</pre>
<pre>mov r5, 0</pre>
<pre>ldr r0, [r3]</pre>
<pre>bl sym.fprintf</pre>
<pre>b 0x17a3c</pre>
<pre>mov r2, r0</pre>
<pre>ldr r0, obj.stderr</pre>
<pre>ldr r1, str._s:_invalid_mountpoint__s_n</pre>
<pre>mov r3, r7</pre>
<pre>ldr r0, [r0]</pre>
<pre>bl sym.fprintf</pre>
<pre>b 0x17a3c</pre>
<pre>ldr r5, [0x00017ba0]</pre>
<pre>mov r6, r4</pre>
<pre>b 0x17a78</pre>
<pre>mov r0, r5</pre>
<pre>ldr r1, str._s_s</pre>
<pre>mov r2, r8</pre>
<pre>mov r3, r6</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>b 0x17a34</pre>
<pre>ldr r3, obj.stderr</pre>
<pre>--</pre>
<pre>bne 0x464a0</pre>
<pre>ldr r3, [r5, 0xc]</pre>
<pre>ldr r2, [r5, 0x10]</pre>
<pre>add r2, r2, r3, lsl 2</pre>
<pre>subs r3, r3, 1</pre>
<pre>bmi 0x464d8</pre>
<pre>ldr r1, [r2, -4]!</pre>
<pre>cmp r6, r1</pre>
<pre>bne 0x464c4</pre>
<pre>mvn r5, r3</pre>
<pre>lsr r5, r5, 0x1f</pre>
<pre>mov r0, r5</pre>
<pre>add sp, sp, 0x64</pre>
<pre>add sp, sp, 0x400</pre>
<pre>pop {r4, r5, r6, r7, r8, sb, sl, fp, pc}</pre>
<pre>ldr r2, [r0, 0x18]</pre>
<pre>add fp, sp, 0x420</pre>
<pre>ldr r1, str._proc__u_task__u_status</pre>
<pre>mov r0, fp</pre>
<pre>mov r3, r2</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>mov r1, r4</pre>
<pre>mov r0, fp</pre>
<pre>--</pre>
<pre>ldr r2, [r3, 4]</pre>
<pre>lsl r2, r2, 3</pre>
<pre>bl 0x5a8d0</pre>
<pre>tst r6, 0x3f8</pre>
<pre>ldreq r3, [0x0005adb8]</pre>
<pre>addeq r3, r4, r3</pre>
<pre>ldreq r3, [r3, 4]</pre>
<pre>orreq r6, r6, r3, lsl 3</pre>
<pre>add r7, sp, 0x420</pre>
<pre>add r8, sp, 0x14</pre>
<pre>add r7, r7, 4</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.__GI_time</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.__GI_ctime</pre>
<pre>ldr r1, [0x0005adbc]</pre>
<pre>add r3, r0, 4</pre>
<pre>mov r2, r6</pre>
<pre>mov r0, r8</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>ldr r3, [0x0005adc0]</pre>
<pre>add r8, r8, r0</pre>
<pre>ldr r6, [r4, r3]</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.strlen</pre>
<pre>cmp r0, 0x3c0</pre>
<pre>bhs 0x5ab9c</pre>
<pre>ldr r1, [0x0005adc4]</pre>
<pre>mov r0, r8</pre>
<pre>mov r2, r6</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>b 0x5abac</pre>
<pre>ldr r1, [0x0005adc8]</pre>
<pre>mov r0, r8</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>ldr r3, [0x0005adb0]</pre>
<pre>add r7, r8, r0</pre>
<pre>add r3, r4, r3</pre>
<pre>ldr r3, [r3, 4]</pre>
<pre>tst r3, 1</pre>
<pre>beq 0x5abe0</pre>
<pre>bl sym.getpid</pre>
<pre>ldr r1, [0x0005adcc]</pre>
<pre>mov r2, r0</pre>
<pre>mov r0, r7</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>add r7, r7, r0</pre>
<pre>mov r6, r7</pre>
<pre>--</pre>
<pre>ble 0x63550</pre>
<pre>add r3, r5, r2</pre>
<pre>ldrb r3, [r3, -1]</pre>
<pre>cmp r3, 0x2f</pre>
<pre>beq 0x63534</pre>
<pre>add r3, sl, 8</pre>
<pre>add r3, r3, r2</pre>
<pre>cmp r7, r3</pre>
<pre>bhs 0x63574</pre>
<pre>bl sym.__errno_location</pre>
<pre>mov r3, 0x16</pre>
<pre>str r3, [r0]</pre>
<pre>mvn r0, 0</pre>
<pre>b 0x63594</pre>
<pre>ldr r1, [0x000635a4]</pre>
<pre>mov r0, r6</pre>
<pre>mov r3, r5</pre>
<pre>str sl, [sp]</pre>
<pre>str r8, [sp, 4]</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>mov r0, 0</pre>
<pre>pop {r1, r2, r3, r4, r5, r6, r7, r8, sl, pc}</pre>
<pre>--</pre>
<pre>push {r4, r5, r6, r7, lr}</pre>
<pre>sub sp, sp, 0x410</pre>
<pre>sub sp, sp, 4</pre>
<pre>ldr r6, [0x0006bac4]</pre>
<pre>mov r4, r0</pre>
<pre>mov r7, r1</pre>
<pre>bl 0x6b844</pre>
<pre>subs r5, r0, 0</pre>
<pre>add r6, pc, r6</pre>
<pre>beq 0x6bab4</pre>
<pre>ldr r3, [r4, 4]</pre>
<pre>add r1, sp, 0x400</pre>
<pre>mov r0, r4</pre>
<pre>add r1, r1, 4</pre>
<pre>ldr r3, [r3, 8]</pre>
<pre>blx r3</pre>
<pre>ldr r1, [0x0006bac8]</pre>
<pre>mov r2, r7</pre>
<pre>mov r0, r5</pre>
<pre>add r1, r6, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>add r4, r5, r0</pre>
<pre>ldr r0, [sp, 0x404]</pre>
<pre>--</pre>
<pre>mov r7, 0</pre>
<pre>ldr r1, [0x0006bad4]</pre>
<pre>mov r0, r4</pre>
<pre>add r1, r6, r1</pre>
<pre>bl sym.strcpy</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.strlen</pre>
<pre>cmp r7, 0</pre>
<pre>add r4, r4, r0</pre>
<pre>beq 0x6ba64</pre>
<pre>mov r0, r4</pre>
<pre>mov r1, r7</pre>
<pre>bl sym.strcpy</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.strlen</pre>
<pre>b 0x6baa0</pre>
<pre>ldr r1, [0x0006bad8]</pre>
<pre>mov r0, r4</pre>
<pre>ldr r2, [sp, 0x408]</pre>
<pre>add r1, r6, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>b 0x6baa0</pre>
<pre>mov r0, r4</pre>
<pre>ldr r1, [0x0006badc]</pre>
<pre>b 0x6ba90</pre>
<pre>ldr r1, [0x0006bae0]</pre>
<pre>mov r0, r4</pre>
<pre>add r1, r6, r1</pre>
<pre>ldr r2, [sp, 0x408]</pre>
<pre>ldr r3, [sp, 0x40c]</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>add r4, r4, r0</pre>
<pre>mov r3, 0xa</pre>
<pre>--</pre>
<pre>ldr r1, [r3]</pre>
<pre>pop {r4, lr}</pre>
<pre>b sym.__GI_fputs</pre>
<pre>andeq fp, r1, r4, lsl 16</pre>
<pre>andeq r0, r0, r8, ror 2</pre>
<pre>push {r4, r5, r6, r7, lr}</pre>
<pre>sub sp, sp, 0x400</pre>
<pre>sub sp, sp, 4</pre>
<pre>ldr r4, [0x0006bc2c]</pre>
<pre>mov r7, r0</pre>
<pre>bl 0x6b844</pre>
<pre>subs r6, r0, 0</pre>
<pre>add r4, pc, r4</pre>
<pre>beq 0x6bc1c</pre>
<pre>bl sym.__GI___rpc_thread_createerr</pre>
<pre>ldr r1, [0x0006bc30]</pre>
<pre>mov r2, r7</pre>
<pre>mov r5, r0</pre>
<pre>mov r0, r6</pre>
<pre>add r1, r4, r1</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>add r7, r6, r0</pre>
<pre>ldr r0, [r5]</pre>
<pre>--</pre>
<pre>bne 0x6c208</pre>
<pre>ldr r4, [sp, 0xc]</pre>
<pre>add r3, sp, 0x60</pre>
<pre>rsb r2, r7, r3</pre>
<pre>mov r1, r7</pre>
<pre>sub r2, r2, 0x22</pre>
<pre>add r0, r4, 0xc</pre>
<pre>bl 0x6bee8</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x6c298</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.strlen</pre>
<pre>add r7, r7, r0</pre>
<pre>b 0x6c240</pre>
<pre>add r1, sp, 0x60</pre>
<pre>mov r0, r7</pre>
<pre>add r3, r1, sl, lsl 2</pre>
<pre>mov r1, r4</pre>
<pre>ldr r2, [r3, -0x20]</pre>
<pre>str ip, [sp, 4]</pre>
<pre><span class="red">bl sym.sprintf</span></pre>
<pre>ldr ip, [sp, 4]</pre>
<pre>add r7, r7, r0</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">sprintf</span> used </span><span class="orange">17</span> times </span><span class="orange">ntfs-3g</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

// the following function is currently not used
// it is for future extensions
function overlay_output(link) {
  var rawfile = new XMLHttpRequest();
  rawfile.open('GET', link, false);
  rawfile.overrideMimeType("text");
  rawfile.onreadystatechange = function()
  {
    alert(rawfile.responseText);
    //console.log(rawfile.responseText);
  }
  rawfile.send(null);
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
